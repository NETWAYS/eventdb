#
#	EventDB v1.2 
#	
#	Quick installation guide for Web interfaces
#	
#	Author: Jannis Moßhammer <jannis.mosshammer@netways.de>
#   2011 © Netways GmbH
#

Prerequisites

Classic UI:

	- PHP 5.2+
	- MySQL Server

Additional prerequisites for Icinga-web cronk:

	- Icinga-Web 1.3+ 

syslogng2mysl:

	- The NetAddr::IP::Util module  (cpan NetAddr::IP:Util)

check_eventdb plugin:
	
	- Python 2.4+ 


Installation:


Common for Icinga-Cronk and Classic Webinterface:

1.) in your mysql console (change user or pass if you want to):
	"CREATE USER 'eventdb' IDENTIFIED BY 'eventdb';"
	"CREATE DATABASE 'eventdb'";
	"GRANT SELECT, INSERT, CREATE TABLE, DELETE, UPDATE ON eventdb.* to eventdb"


Classic interface:

1.) run sql/create_tables.sql

2.) Copy classicWeb/index.php to your webservers path


Icinga-Cronk:

1.) cd ./icinga-cronk

2.) vi db.ini and update database information

3.) run ./install.sh

4.) in your /usr/local/icinga-web/app/config/database.xml:
	Add the following snippet BEFORE our icinga_web config (otherwise the config will crash)


	<database xmlns="http://agavi.org/agavi/config/parts/databases/1.0" name="eventdb_w" class="AgaviDoctrineDatabase">
		<ae:parameter name="dsn">mysql://eventdb:eventdb@localhost:3306/eventdb</ae:parameter>
		<ae:parameter name="charset">utf8</ae:parameter>
		<ae:parameter name="manager_attributes">
			<ae:parameter name="Doctrine_Core::ATTR_MODEL_LOADING">CONSERVATIVE</ae:parameter>
		</ae:parameter>
		<ae:parameter name="load_models">%core.module_dir%/AppKit/lib/database/models/generated</ae:parameter>
		<ae:parameter name="models_directory">%core.module_dir%/AppKit/lib/database/models</ae:parameter>	
	</database>

	<database xmlns="http://agavi.org/agavi/config/parts/databases/1.0" name="eventdb_r" class="AgaviDoctrineDatabase">
		<ae:parameter name="dsn">mysql://eventdb:eventdb@localhost:3306/eventdb</ae:parameter>
		<ae:parameter name="charset">utf8</ae:parameter>
		<ae:parameter name="manager_attributes">
			<ae:parameter name="Doctrine_Core::ATTR_MODEL_LOADING">CONSERVATIVE</ae:parameter>
		</ae:parameter>
		<ae:parameter name="load_models">%core.module_dir%/AppKit/lib/database/models/generated</ae:parameter>
		<ae:parameter name="models_directory">%core.module_dir%/AppKit/lib/database/models</ae:parameter>	
	</database>

5. ) In order to have a link from host/services to the eventdb cronk, run the plugin with the --cventry command and copy the returned customvar to your service/host check


